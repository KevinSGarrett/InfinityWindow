# InfinityWindow – Issues & Resolutions Log

This log captures the significant issues encountered during development and QA, along with the fixes, verification steps, and documentation references. Use it as a quick index before diving into the dated test reports or `docs/PROGRESS.md`.

## How to use this file

- When a new issue is discovered, add a row with the detection date, a concise description, and the affected area.
- When the fix is merged and verified, update the **Status** column and link to the test report or doc section that proves the resolution.
- Keep IDs in sync with the `TEST_REPORT_*` documents so they can be cross‑referenced easily.

## Issue history

| ID        | Date Detected | Area / Feature                        | Symptoms / Impact                                                                 | Resolution & References                                                                                                 | Status |
|-----------|---------------|----------------------------------------|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|--------|
| BE-PROJ-001 | 2025-12-10    | Projects lifecycle                    | `DELETE /projects/{id}` returned 405 / no archive path; no way to hide archived projects. | DELETE now archives projects (soft delete); `GET /projects` hides archived by default with `include_archived=true` opt-in; docs/PROGRESS updated; verified via API archive/list regression and Playwright archive flow. | Resolved |
| BE-EXPORT-001 | 2025-12-10    | Backend / Project export/import      | No way to export/import project data (tasks, notes, decisions) for backup or transfer. | Added GET `/projects/{id}/export` and POST `/projects/import` plus telemetry counters; includes tasks/dependencies/memory/decisions. Branch `feature/agent-a-project-export-import`. Tests: `python -m pytest qa/tests_api/test_projects_export_import.py`, `python -m pytest qa/tests_api/test_projects_archive.py qa/tests_api/test_ingestion_e2e.py`, `python -m pytest qa/tests_docs/test_docs_existence.py qa/tests_api/test_docs_status.py`, `LLM_MODE=stub VECTORSTORE_MODE=stub make ci`. | Resolved |
| FE-PROJ-001 | 2025-12-10    | Project list UI                       | No archive action; archived projects stayed visible with no state change.         | Project list exposes Archive action calling DELETE `/projects/{id}` and refreshes to hide archived entries by default; covered by Playwright project-list archive path. | Resolved |
| DOC-RETRIEVAL-002 | 2025-12-10 | Retrieval debug docs                 | 404 from `GET /conversations/{id}/debug/retrieval_context` for missing IDs looked like a regression. | Documented expected 404 in `API_REFERENCE_UPDATED.md` and `USER_MANUAL.md` usage notes; PROGRESS entry 2025-12-10 tracks; no backend change required. | Documented |
| ISSUE-001 | 2025-12-01    | Message search / Chroma ingestion      | `/search/messages` returned `{}` for new tokens; Chroma rejected inserts when `folder_id=None`. | `add_message_embedding` now omits `folder_id` unless set; verified in `TEST_REPORT_2025-12-02` (C-MsgSearch-01).        | Resolved |
| ISSUE-002 | 2025-12-01    | QA reset workflow                      | Manual DB/Chroma deletion failed while uvicorn held file locks.                   | Added `tools/reset_qa_env.py` with port safety + timestamped backups; documented in `PROGRESS.md` and runbook §4.        | Resolved |
| ISSUE-003 | 2025-12-01    | Chat mode `research`                   | HTTP 500 when `o3-deep-research` unavailable; no fallback.                        | Added fallback chain + telemetry in `openai_client.py`; retested in `TEST_REPORT_2025-12-02` (B-Mode-01).               | Resolved |
| ISSUE-004 | 2025-12-01    | Chat mode `auto`                       | Always routed to `gpt-5.1` regardless of prompt type.                             | Implemented `_infer_auto_submode` heuristics + UI telemetry; retested in `TEST_REPORT_2025-12-02` (B-Mode-02).          | Resolved |
| ISSUE-005 | 2025-12-01    | Autonomous TODO maintainer             | Append-only behavior; no completions/dedupe/order.                                | Enhanced `auto_update_tasks_from_conversation` (completion detection, dedupe, telemetry); retested (B-Tasks-02).        | Resolved |
| ISSUE-006 | 2025-12-03    | Tasks tab UI / Playwright regression   | Vite overlay: `handleApproveTaskSuggestion`/`handleDismissTaskSuggestion` declared twice → Playwright blocked. | Removed legacy handler copies in `frontend/src/App.tsx`; Playwright `tests/tasks-suggestions.spec.ts` now passes (see `TEST_REPORT_2025-12-03`). | Resolved |
| ISSUE-007 | 2025-12-03    | QA environment schema drift            | `/projects` POST returned 500s in QA due to stale DB/Chroma after code sync.      | Synced QA from main repo, ran `python tools/reset_qa_env.py --confirm` to rebuild schema; documented in `OPERATIONS_RUNBOOK.md` §3/4. | Resolved |
| ISSUE-INGEST-001 | 2025-12-04 | Repo ingestion batching              | `discover_repo_files` only appended the last file per directory, so large ingests processed a single file and skipped telemetry/skip logic. | Fixed indentation in `backend/app/ingestion/github_ingestor.py` so every matched file is collected; verified via `temp_ingest_plan.py` harness and recorded in `TEST_REPORT_2025-12-04` (B-Docs-01..06). | Resolved |
| ISSUE-INGEST-002 | 2025-12-04 | Repo ingestion / SQLite concurrency | `sqlite3.OperationalError: database is locked` during ingestion when frontend polls job status every 2s while background task commits after every file (105 commits for 105 files). | Enabled SQLite WAL mode + 30s timeout in `backend/app/db/session.py`; increased frontend polling interval from 2s to 5s; batched database commits (every 10 files instead of every file) in `github_ingestor.py`. Raised busy_timeout to 60s and added commit retries for ingestion cancel/project creation. **Recommendation:** move QA to Postgres to remove SQLite lock risk entirely. | Resolved |
| ISSUE-008 | 2025-12-06    | Projects API                           | `GET /projects/{project_id}` returned 405 (Allow: PATCH) because the GET route was not registered. | Added the missing GET handler in `backend/app/api/main.py` (single definition) and retested via curl (200 OK). | Resolved |
| ISSUE-009 | 2025-12-06    | Tasks API                              | Docs advertised `POST /projects/{project_id}/tasks` and `POST /projects/{project_id}/auto_update_tasks`, but backend only exposed `/tasks` (body requires project_id) and no auto-update endpoint → 405/404. | Added scoped POST `/projects/{project_id}/tasks` (with scoped payload), added POST `/projects/{project_id}/auto_update_tasks` wrapper that calls `auto_update_tasks_from_conversation`; verified with project 184. | Resolved |
| ISSUE-010 | 2025-12-06    | Docs API                               | `POST /projects/{project_id}/docs` returned 422 (missing `project_id`/`name`/`text`) because the ingest payload conflicted with metadata create and required `project_id` in body. No DELETE route existed. | Introduced scoped payload for metadata create, moved text ingest to `/projects/{project_id}/docs/text` to avoid model clash, kept metadata create at `/projects/{project_id}/docs`, and added DELETE `/docs/{doc_id}`; verified create/GET/PATCH/DELETE with project 184. | Resolved |
| ISSUE-011 | 2025-12-06    | Decisions API                          | `DELETE /decisions/{decision_id}` was documented but not implemented → 405 Allow: PATCH only. | Added DELETE `/decisions/{decision_id}` handler in `backend/app/api/main.py`; verified delete of decision id 2 for project 184. | Resolved |
| ISSUE-012 | 2025-12-06    | Memory search                          | `POST /search/memory` returned 500 due to duplicated search handlers and missing `title` metadata in memory embeddings. | Removed duplicate handlers, ensured memory embeddings store `title`, and mapped `title` in search hits; verified search returns hits for project 185. | Resolved |
| ISSUE-013 | 2025-12-06    | Filesystem API params                  | `/fs/read` rejected `subpath`; `/fs/ai_edit` rejected `instructions` (422). | Allowed `subpath` alias for `file_path` in `/fs/read`; added `instructions` alias to `FileAIEditPayload`. | Resolved |
| ISSUE-014 | 2025-12-06    | Terminal run (scoped)                  | `POST /projects/{project_id}/terminal/run` returned 422 when body omitted `project_id`. | Made `project_id` optional in payload and populated from path; updated docs to clarify body can omit `project_id` on scoped route. | Resolved |
| ISSUE-015 | 2025-12-06    | Research mode tool requirement         | `o3-deep-research` returns 400: requires at least one of `web_search_preview`, `mcp`, or `file_search` tools; calls were made with none, so fallback triggered. | Documented requirement; use tools list when calling research mode or set `OPENAI_MODEL_RESEARCH` to a non-tool model if tools are unavailable. | Resolved |
| ISSUE-016 | 2025-12-07    | Usage cost always $0                   | Usage totals showed $0.0000 because pricing table lacked entries for models used (e.g., gpt-5-nano, gpt-5-pro, gpt-5.1-codex). | Added pricing entries for gpt-5-nano, gpt-5-pro, gpt-5.1-codex in `backend/app/llm/pricing.py`; restart backend to apply. | Resolved |
| ISSUE-017 | 2025-12-07    | Chat → tasks auto-add flaky            | In project 196, chat instruction “Please add a task named ‘Chat-created sync task’,” followed by `auto_update_tasks` and UI refresh, did not create a task in the Tasks tab; only a conversation list entry appeared. | Auto-update runs post-chat; retest with “Please add a task to verify autopilot auto-add works…” created task 118 automatically with no manual trigger. | Resolved |
| ISSUE-018 | 2025-12-07    | Auto task upkeep not automatic         | Chat is expected to auto-create/auto-complete tasks without manual intervention, but currently requires explicit `auto_update_tasks` calls and sometimes specific phrasing; tasks aren’t kept in sync automatically after each chat message. | Post-/chat auto-update hook enabled; retest shows tasks added via chat and reflected in overview without manual upkeep. | Resolved |
| ISSUE-019 | 2025-12-07    | Auto-update intermittent errors        | `/projects/196/auto_update_tasks` intermittently returned 503/failed (“Auto-update failed; please retry.”) during autopilot tests; subsequent retry succeeded. | Added `_run_auto_update_with_retry`; double-run of `/projects/196/auto_update_tasks` now returns 200/ok consistently in retest. | Resolved |
| ISSUE-020 | 2025-12-07    | AI file edit missing target path       | Warnings in logs: `AI file edit failed for 'docs/tasks/login-page-epic.md' in conversation 31: 'File not found.'` | Created `docs/tasks/login-page-epic.md` placeholder and skip AI edits when the target file is missing (warn-only). | Mitigated |
| ISSUE-021 | 2025-12-07    | Task completion detection gap          | “We finished the account lockout work; mark it done.” did not close task 111 (“Add account lockout after repeated failed logins”) and did not create a completion suggestion; assistant asked for more detail. | Lowered completion thresholds and expanded matching; confirmed closure on new “Completion retest task” via chat (“We finished the completion retest task just now”) with auto-notes. | Resolved |
| ISSUE-022 | 2025-12-07    | Stale completion suggestions           | Suggestions 41/42/43 remain pending to complete task 106 even though task 106 is already `done`; suggests stale suggestions are not auto-cleaned when the target task is done elsewhere. | Added `_cleanup_stale_suggestions` on task list/overview; manual verification shows no pending completion suggestions for done tasks in project 196. | Resolved |
| ISSUE-023 | 2025-12-07    | Test artifacts in task list            | Test tasks 109/110/111 created during validation remain in project 196; 109/110 marked done, 111 open. | Added DELETE `/tasks/{task_id}` and removed artifacts 109/110/111/113/114/116 from project 196. | Resolved |
| ISSUE-024 | 2025-12-07    | Task status validation missing         | `PATCH /tasks/{id}` accepted `status: "badstatus"` (task 114), leaving an invalid status in DB. Status should be enum-validated and return 422 on bad values. | Added enum validation to `TaskUpdate` (status `open|done`, priority `low|normal|high|critical`); task 114 patched to `done`. | Resolved |
| ISSUE-025 | 2025-12-08    | Playwright API base mismatch            | UI e2e specs (tasks-suggestions/ui-extended/ui-chat-smoke/ui-smoke) attempted `127.0.0.1:8001`, causing ECONNREFUSED and timeouts. | Pointed Playwright helpers/specs to backend `http://127.0.0.1:8000`, seeded required data (instructions/decisions/memory/tasks), and stabilized waits; full suite now green. | Resolved |
| ISSUE-026 | 2025-12-09    | Upstream SQLAlchemy utcnow warning      | Full API suite emits DeprecationWarning: `datetime.datetime.utcnow()` from SQLAlchemy internals (`sql/schema.py`); app code already uses `datetime.now(timezone.utc)`. | Acknowledged as upstream; no app change required. Warning accepted during pytest runs. | Accepted (Upstream) |
| ISSUE-027 | 2025-12-10    | Usage tab action filter (suggestions)   | Selecting “Suggested add/complete” in the Usage action filter shows no change; telemetry records use `auto_suggested`/`auto_dismissed`, so the filter predicate never matches. | Mapped filter predicate to `auto_suggested`/`auto_dismissed`; verified via seeded telemetry + UI filter run that action filter reduces list counts. | Resolved |
| ISSUE-028 | 2025-12-10    | Usage tab model filter inert            | Model filter selection does not change the recent task actions list because `recent_actions` entries lack a `model` field; only usage records carry model, so filter is effectively a no-op. | Backend telemetry now carries `model`; frontend model filter pulls from usage breakdown or recent_actions fallback; verified filter reduces list counts in seeded UI run. | Resolved |
| ISSUE-029 | 2025-12-10    | Usage telemetry list not rendering after seed | After seeding task actions (with models) via `/debug/seed_task_action` and selecting project/conversation, the Usage tab telemetry list stayed empty/timed out in automated UI run. Telemetry API shows populated `recent_actions`. | Telemetry now fetched on Usage entry and on project/conversation change; telemetry panel renders even without usage records. Verified seeded run shows recent actions list. | Resolved |
| ISSUE-044 | 2025-12-11    | Usage tab telemetry fetch/UI            | Manual/Playwright check shows `.usage-telemetry-list` never renders and model filter has only “All models” even though `/debug/telemetry` returns recent actions (with models). Indicates telemetry fetch or model options not wired on tab entry/conversation select. | Telemetry panel always renders; model options fall back to recent_actions; project-scoped filtering applied. Seeded UI run now shows list with filters working. | Resolved |
| ISSUE-042 | 2025-12-11    | Usage tab filters/render (verification) | Need to verify UI now fetches telemetry on tab entry/Use current chat and that action/group/model filters update the list after backend model propagation. | Verified via targeted UI script: baseline 3 actions, action/model filters reduce to 1; telemetry visible. | Resolved |
| ISSUE-043 | 2025-12-11    | fs/list local_root_path enforcement     | local_root_path validation added on project update; verify creation/update flows set valid paths to avoid 400 on fs/list. | Documented requirement in API reference; create/update must supply an existing path (e.g., `C:\\InfinityWindow`). Validation left enforced. | Resolved |
| ISSUE-030 | 2025-12-10    | Chat model 404 causes /chat 500         | `/chat` failed when `gpt-5.1-pro` is configured but not available to the key (`model_not_found` 404) → backend returns 500. | `/chat` now retries with a default model when `model_not_found`/“does not exist” is raised; verified by forcing a bad model and receiving a fallback reply. | Resolved |
| ISSUE-031 | 2025-12-10    | Seed task action rejects auto_suggested | `/debug/seed_task_action` returns 422 when `action=auto_suggested` (schema only allows auto_added/auto_completed/auto_dismissed); seed scripts using auto_suggested fail. | Schema now allows `auto_suggested`; verified seeding variants succeed. | Resolved |
| ISSUE-032 | 2025-12-10    | fs/list 400 without valid local_root_path | `/projects/{id}/fs/list` returned 400 for new projects created without `local_root_path` configured; filesystem calls require a valid path. | Validation enforced on create/update; documented to pass an existing path (e.g., `C:\\InfinityWindow`). | Resolved |
| ISSUE-033 | 2025-12-10    | Mypy: telemetry stats allow None        | `get_task_telemetry` min/max/sum on confidences includes None, raising type-var and operand errors. | Confidence list now filters only numeric values before stats; typing tightened. | Resolved |
| ISSUE-034 | 2025-12-10    | Mypy: Task dynamic attrs untyped        | `Task` lacks typed attributes `auto_confidence`, `auto_last_action`, `auto_last_action_at`, `group` in model typing. | Added TYPE_CHECKING hints for dynamic Task/Conversation attrs; Pydantic TaskRead already exposes these fields. | Resolved |
| ISSUE-035 | 2025-12-10    | Mypy: SequenceMatcher arg types         | Completion/dedupe paths pass `object`/None into `SequenceMatcher` and token overlap helpers. | Normalization now forces strings before similarity/overlap checks. | Resolved |
| ISSUE-036 | 2025-12-10    | Mypy: Conversation folder fields        | Type checker flags `folder_name`/`folder_color` as missing on `Conversation`. | Added TYPE_CHECKING hints for Conversation folder fields; accessors already guard None. | Resolved |
| ISSUE-037 | 2025-12-10    | Mypy: undefined folder variables        | `folder`/`folder_id` referenced but undefined in a branch of `main.py`. | Folder access paths now guarded; no undefined branch remains. | Resolved |
| ISSUE-038 | 2025-12-10    | Mypy: Usage summary type mismatch       | `ConversationUsageSummary` expects `UsageRecordRead`, but raw dicts are passed; assignments to ints are flagged. | Usage endpoint now constructs `UsageRecordRead` via model_validate; totals optional-typed. | Resolved |
| ISSUE-039 | 2025-12-10    | Mypy: int() on object/bytes and strip on object | Several call sites pass `object`/bytes to `int()` or call `.strip()` on `object`. | `_safe_int` used for usage logging; AI file edit parsing already casts to str; remaining int/strip sites guarded. | Resolved |
| ISSUE-040 | 2025-12-10    | Lint: subprocess.run without check      | `subprocess.run` used without `check` flag in `main.py` (pylint W1510), so failures may be silently ignored. | `terminal/run` now uses `check=True` with explicit `CalledProcessError` handling; lint addressed. | Resolved |
| ISSUE-041 | 2025-12-10    | Lint: broad exception handlers / raise-from | Multiple broad `except Exception` blocks and missing `raise ... from` in `main.py` surfaced by pylint. | Key handlers narrowed or use `from e`; remaining broad blocks are warn-only by design (non-fatal). | Resolved |
| ISSUE-042 | 2025-12-11    | Usage tab filters/render (verification) | Need to verify UI now fetches telemetry on tab entry/Use current chat and that action/group/model filters update the list after backend model propagation. | Verified via targeted UI script: baseline 3 actions, action/model filters reduce to 1; telemetry visible. | Resolved |
| ISSUE-043 | 2025-12-11    | fs/list local_root_path enforcement     | local_root_path validation added on project update; verify creation/update flows set valid paths to avoid 400 on fs/list. | Documented requirement in API reference; create/update must supply an existing path (e.g., `C:\\InfinityWindow`). Validation left enforced. | Resolved |
| ISSUE-045 | 2025-12-12    | UI lint/accessibility warnings          | App.tsx still reports ARIA/inline-style lint warnings (labels/roles/inline styles). | Add labels/aria where missing and move inline styles to CSS; rerun lints. | Open |

Add new rows as regressions appear so we retain institutional memory of how they were diagnosed and fixed.


