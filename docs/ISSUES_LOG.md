# InfinityWindow – Issues & Resolutions Log

This log captures the significant issues encountered during development and QA, along with the fixes, verification steps, and documentation references. Use it as a quick index before diving into the dated test reports or `docs/PROGRESS.md`.

## How to use this file

- When a new issue is discovered, add a row with the detection date, a concise description, and the affected area.
- When the fix is merged and verified, update the **Status** column and link to the test report or doc section that proves the resolution.
- Keep IDs in sync with the `TEST_REPORT_*` documents so they can be cross‑referenced easily.

## Issue history

| ID        | Date Detected | Area / Feature                        | Symptoms / Impact                                                                 | Resolution & References                                                                                                 | Status |
|-----------|---------------|----------------------------------------|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|--------|
| ISSUE-001 | 2025-12-01    | Message search / Chroma ingestion      | `/search/messages` returned `{}` for new tokens; Chroma rejected inserts when `folder_id=None`. | `add_message_embedding` now omits `folder_id` unless set; verified in `TEST_REPORT_2025-12-02` (C-MsgSearch-01).        | Resolved |
| ISSUE-002 | 2025-12-01    | QA reset workflow                      | Manual DB/Chroma deletion failed while uvicorn held file locks.                   | Added `tools/reset_qa_env.py` with port safety + timestamped backups; documented in `PROGRESS.md` and runbook §4.        | Resolved |
| ISSUE-003 | 2025-12-01    | Chat mode `research`                   | HTTP 500 when `o3-deep-research` unavailable; no fallback.                        | Added fallback chain + telemetry in `openai_client.py`; retested in `TEST_REPORT_2025-12-02` (B-Mode-01).               | Resolved |
| ISSUE-004 | 2025-12-01    | Chat mode `auto`                       | Always routed to `gpt-5.1` regardless of prompt type.                             | Implemented `_infer_auto_submode` heuristics + UI telemetry; retested in `TEST_REPORT_2025-12-02` (B-Mode-02).          | Resolved |
| ISSUE-005 | 2025-12-01    | Autonomous TODO maintainer             | Append-only behavior; no completions/dedupe/order.                                | Enhanced `auto_update_tasks_from_conversation` (completion detection, dedupe, telemetry); retested (B-Tasks-02).        | Resolved |
| ISSUE-006 | 2025-12-03    | Tasks tab UI / Playwright regression   | Vite overlay: `handleApproveTaskSuggestion`/`handleDismissTaskSuggestion` declared twice → Playwright blocked. | Removed legacy handler copies in `frontend/src/App.tsx`; Playwright `tests/tasks-suggestions.spec.ts` now passes (see `TEST_REPORT_2025-12-03`). | Resolved |
| ISSUE-007 | 2025-12-03    | QA environment schema drift            | `/projects` POST returned 500s in QA due to stale DB/Chroma after code sync.      | Synced QA from main repo, ran `python tools/reset_qa_env.py --confirm` to rebuild schema; documented in `OPERATIONS_RUNBOOK.md` §3/4. | Resolved |
| ISSUE-INGEST-001 | 2025-12-04 | Repo ingestion batching              | `discover_repo_files` only appended the last file per directory, so large ingests processed a single file and skipped telemetry/skip logic. | Fixed indentation in `backend/app/ingestion/github_ingestor.py` so every matched file is collected; verified via `temp_ingest_plan.py` harness and recorded in `TEST_REPORT_2025-12-04` (B-Docs-01..06). | Resolved |
| ISSUE-INGEST-002 | 2025-12-04 | Repo ingestion / SQLite concurrency | `sqlite3.OperationalError: database is locked` during ingestion when frontend polls job status every 2s while background task commits after every file (105 commits for 105 files). | Enabled SQLite WAL mode + 30s timeout in `backend/app/db/session.py`; increased frontend polling interval from 2s to 5s; batched database commits (every 10 files instead of every file) in `github_ingestor.py`. Raised busy_timeout to 60s and added commit retries for ingestion cancel/project creation. **Recommendation:** move QA to Postgres to remove SQLite lock risk entirely. | Resolved |
| ISSUE-008 | 2025-12-06    | Projects API                           | `GET /projects/{project_id}` returned 405 (Allow: PATCH) because the GET route was not registered. | Added the missing GET handler in `backend/app/api/main.py` (single definition) and retested via curl (200 OK). | Resolved |
| ISSUE-009 | 2025-12-06    | Tasks API                              | Docs advertised `POST /projects/{project_id}/tasks` and `POST /projects/{project_id}/auto_update_tasks`, but backend only exposed `/tasks` (body requires project_id) and no auto-update endpoint → 405/404. | Added scoped POST `/projects/{project_id}/tasks` (with scoped payload), added POST `/projects/{project_id}/auto_update_tasks` wrapper that calls `auto_update_tasks_from_conversation`; verified with project 184. | Resolved |
| ISSUE-010 | 2025-12-06    | Docs API                               | `POST /projects/{project_id}/docs` returned 422 (missing `project_id`/`name`/`text`) because the ingest payload conflicted with metadata create and required `project_id` in body. No DELETE route existed. | Introduced scoped payload for metadata create, moved text ingest to `/projects/{project_id}/docs/text` to avoid model clash, kept metadata create at `/projects/{project_id}/docs`, and added DELETE `/docs/{doc_id}`; verified create/GET/PATCH/DELETE with project 184. | Resolved |
| ISSUE-011 | 2025-12-06    | Decisions API                          | `DELETE /decisions/{decision_id}` was documented but not implemented → 405 Allow: PATCH only. | Added DELETE `/decisions/{decision_id}` handler in `backend/app/api/main.py`; verified delete of decision id 2 for project 184. | Resolved |
| ISSUE-012 | 2025-12-06    | Memory search                          | `POST /search/memory` returned 500 due to duplicated search handlers and missing `title` metadata in memory embeddings. | Removed duplicate handlers, ensured memory embeddings store `title`, and mapped `title` in search hits; verified search returns hits for project 185. | Resolved |
| ISSUE-013 | 2025-12-06    | Filesystem API params                  | `/fs/read` rejected `subpath`; `/fs/ai_edit` rejected `instructions` (422). | Allowed `subpath` alias for `file_path` in `/fs/read`; added `instructions` alias to `FileAIEditPayload`. | Resolved |
| ISSUE-014 | 2025-12-06    | Terminal run (scoped)                  | `POST /projects/{project_id}/terminal/run` returned 422 when body omitted `project_id`. | Made `project_id` optional in payload and populated from path; updated docs to clarify body can omit `project_id` on scoped route. | Resolved |
| ISSUE-015 | 2025-12-06    | Research mode tool requirement         | `o3-deep-research` returns 400: requires at least one of `web_search_preview`, `mcp`, or `file_search` tools; calls were made with none, so fallback triggered. | Documented requirement; use tools list when calling research mode or set `OPENAI_MODEL_RESEARCH` to a non-tool model if tools are unavailable. | Resolved |
| ISSUE-016 | 2025-12-07    | Usage cost always $0                   | Usage totals showed $0.0000 because pricing table lacked entries for models used (e.g., gpt-5-nano, gpt-5-pro, gpt-5.1-codex). | Added pricing entries for gpt-5-nano, gpt-5-pro, gpt-5.1-codex in `backend/app/llm/pricing.py`; restart backend to apply. | Resolved |
| ISSUE-017 | 2025-12-07    | Chat → tasks auto-add flaky            | In project 196, chat instruction “Please add a task named ‘Chat-created sync task’,” followed by `auto_update_tasks` and UI refresh, did not create a task in the Tasks tab; only a conversation list entry appeared. | Auto-update runs post-chat; retest with “Please add a task to verify autopilot auto-add works…” created task 118 automatically with no manual trigger. | Resolved |
| ISSUE-018 | 2025-12-07    | Auto task upkeep not automatic         | Chat is expected to auto-create/auto-complete tasks without manual intervention, but currently requires explicit `auto_update_tasks` calls and sometimes specific phrasing; tasks aren’t kept in sync automatically after each chat message. | Post-/chat auto-update hook enabled; retest shows tasks added via chat and reflected in overview without manual upkeep. | Resolved |
| ISSUE-019 | 2025-12-07    | Auto-update intermittent errors        | `/projects/196/auto_update_tasks` intermittently returned 503/failed (“Auto-update failed; please retry.”) during autopilot tests; subsequent retry succeeded. | Added `_run_auto_update_with_retry`; double-run of `/projects/196/auto_update_tasks` now returns 200/ok consistently in retest. | Resolved |
| ISSUE-020 | 2025-12-07    | AI file edit missing target path       | Warnings in logs: `AI file edit failed for 'docs/tasks/login-page-epic.md' in conversation 31: 'File not found.'` | Created `docs/tasks/login-page-epic.md` placeholder and skip AI edits when the target file is missing (warn-only). | Mitigated |
| ISSUE-021 | 2025-12-07    | Task completion detection gap          | “We finished the account lockout work; mark it done.” did not close task 111 (“Add account lockout after repeated failed logins”) and did not create a completion suggestion; assistant asked for more detail. | Lowered completion thresholds and expanded matching; confirmed closure on new “Completion retest task” via chat (“We finished the completion retest task just now”) with auto-notes. | Resolved |
| ISSUE-022 | 2025-12-07    | Stale completion suggestions           | Suggestions 41/42/43 remain pending to complete task 106 even though task 106 is already `done`; suggests stale suggestions are not auto-cleaned when the target task is done elsewhere. | Added `_cleanup_stale_suggestions` on task list/overview; manual verification shows no pending completion suggestions for done tasks in project 196. | Resolved |
| ISSUE-023 | 2025-12-07    | Test artifacts in task list            | Test tasks 109/110/111 created during validation remain in project 196; 109/110 marked done, 111 open. | Added DELETE `/tasks/{task_id}` and removed artifacts 109/110/111/113/114/116 from project 196. | Resolved |
| ISSUE-024 | 2025-12-07    | Task status validation missing         | `PATCH /tasks/{id}` accepted `status: "badstatus"` (task 114), leaving an invalid status in DB. Status should be enum-validated and return 422 on bad values. | Added enum validation to `TaskUpdate` (status `open|done`, priority `low|normal|high|critical`); task 114 patched to `done`. | Resolved |
| ISSUE-025 | 2025-12-08    | Playwright API base mismatch            | UI e2e specs (tasks-suggestions/ui-extended/ui-chat-smoke/ui-smoke) attempted `127.0.0.1:8001`, causing ECONNREFUSED and timeouts. | Pointed Playwright helpers/specs to backend `http://127.0.0.1:8000`, seeded required data (instructions/decisions/memory/tasks), and stabilized waits; full suite now green. | Resolved |
| ISSUE-026 | 2025-12-09    | Upstream SQLAlchemy utcnow warning      | Full API suite emits DeprecationWarning: `datetime.datetime.utcnow()` from SQLAlchemy internals (`sql/schema.py`); app code already uses `datetime.now(timezone.utc)`. | Acknowledged as upstream; no app change required. Warning accepted during pytest runs. | Accepted (Upstream) |

Add new rows as regressions appear so we retain institutional memory of how they were diagnosed and fixed.


