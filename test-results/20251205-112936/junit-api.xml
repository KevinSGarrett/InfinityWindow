<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="4" skipped="1" tests="10" time="26.426" timestamp="2025-12-05T11:29:44.777018-06:00" hostname="DESKTOP-CJV735V"><testcase classname="test_api_projects" name="test_project_validation_requires_name" time="0.019"><skipped type="pytest.xfail" message="Backend currently allows empty project names (returns 200)." /></testcase><testcase classname="test_ingestion_e2e" name="test_basic_ingestion_happy_path" time="0.288"><failure message="assert 409 == 200&#10; +  where 409 = &lt;Response [409 Conflict]&gt;.status_code">client = &lt;starlette.testclient.TestClient object at 0x0000019C8F87B110&gt;
tmp_path = WindowsPath('C:/Users/Windows 11/AppData/Local/Temp/pytest-of-Windows 11/pytest-18/popen-gw6/test_basic_ingestion_happy_pat0')

    def test_basic_ingestion_happy_path(client, tmp_path):
        """D-Docs-02: Repo ingestion completes for a tiny fixture."""
        repo_root = tmp_path / "fixture_repo"
        repo_root.mkdir()
        (repo_root / "README.md").write_text("# QA Fixture\n\ncontent\n", encoding="utf-8")
    
        proj_resp = client.post(
            "/projects",
            json={
                "name": "Ingestion QA",
                "local_root_path": str(repo_root),
                "description": "fixture project",
            },
        )
&gt;       assert proj_resp.status_code == 200
E       assert 409 == 200
E        +  where 409 = &lt;Response [409 Conflict]&gt;.status_code

C:\InfinityWindow_QA\qa\tests_api\test_ingestion_e2e.py:25: AssertionError</failure></testcase><testcase classname="test_search" name="test_search_requires_existing_project" time="0.310" /><testcase classname="test_api_chat_routing" name="test_chat_modes_stubbed" time="4.320"><failure message="AttributeError: 'dict' object has no attribute 'find'">client = &lt;starlette.testclient.TestClient object at 0x00000142E583F350&gt;
project = {'description': 'QA autogenerated project', 'id': 10, 'instruction_text': None, 'instruction_updated_at': None, ...}

    def test_chat_modes_stubbed(client, project):
        """C-Chat-02: Chat returns stubbed replies for each mode."""
        for mode in ["auto", "fast", "deep", "budget", "research", "code"]:
&gt;           resp = client.post(
                "/chat",
                json={
                    "project_id": project["id"],
                    "mode": mode,
                    "message": f"ping {mode}",
                },
            )

C:\InfinityWindow_QA\qa\tests_api\test_api_chat_routing.py:9: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:546: in post
    return super().post(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:1144: in post
    return self.request(
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:445: in request
    return super().request(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:348: in handle_request
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:345: in handle_request
    portal.call(self.app, scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\from_thread.py:326: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Windows 11\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
C:\Users\Windows 11\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\from_thread.py:257: in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\applications.py:1139: in __call__
    await super().__call__(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\applications.py:107: in __call__
    await self.middleware_stack(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:119: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:105: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:385: in app
    raw_response = await run_endpoint_function(
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:286: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\concurrency.py:32: in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\to_thread.py:61: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\_backends\_asyncio.py:2525: in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\_backends\_asyncio.py:986: in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\backend\app\api\main.py:3534: in chat
    clean_reply_text, file_edit_requests = _extract_ai_file_edits(raw_reply_text)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

reply_text = {'cost_estimate': 0.0, 'model': 'stub-auto', 'reply': '[stub-auto-0984e35b]', 'tokens_in': 737, ...}

    def _extract_ai_file_edits(reply_text: str) -&gt; tuple[str, List[Dict[str, object]]]:
        """
        Look for zero or more AI file edit request blocks in the reply text.
    
        Blocks are delimited like:
    
            &lt;&lt;AI_FILE_EDIT&gt;&gt;
            {"file_path": "backend/app/api/main.py",
             "instruction": "Describe the change to make"}
            &lt;&lt;END_AI_FILE_EDIT&gt;&gt;
    
        Returns:
            (cleaned_reply_text, list_of_edit_dicts)
        """
        edits: List[Dict[str, object]] = []
        start_tag = "&lt;&lt;AI_FILE_EDIT&gt;&gt;"
        end_tag = "&lt;&lt;END_AI_FILE_EDIT&gt;&gt;"
    
        remaining = reply_text
        while True:
&gt;           start = remaining.find(start_tag)
                    ^^^^^^^^^^^^^^
E           AttributeError: 'dict' object has no attribute 'find'

C:\InfinityWindow_QA\backend\app\api\main.py:653: AttributeError</failure></testcase><testcase classname="test_api_projects" name="test_create_list_update_project" time="4.369"><failure message="AssertionError: assert None == 'QA note'">client = &lt;starlette.testclient.TestClient object at 0x00000281180FB200&gt;
project = {'description': 'QA autogenerated project', 'id': 11, 'instruction_text': None, 'instruction_updated_at': None, ...}

    def test_create_list_update_project(client, project):
        """A-Proj-01: Create project, list it, update metadata."""
        list_resp = client.get("/projects")
        assert list_resp.status_code == 200
        assert any(p["id"] == project["id"] for p in list_resp.json())
    
        update = client.patch(
            f"/projects/{project['id']}",
            json={"description": "Updated by QA", "pinned_note_text": "QA note"},
        )
        assert update.status_code == 200
        refreshed = client.get("/projects")
        assert refreshed.status_code == 200
        body = next(p for p in refreshed.json() if p["id"] == project["id"])
        assert body["description"] == "Updated by QA"
&gt;       assert body["pinned_note_text"] == "QA note"
E       AssertionError: assert None == 'QA note'

C:\InfinityWindow_QA\qa\tests_api\test_api_projects.py:24: AssertionError</failure></testcase><testcase classname="test_api_projects" name="test_fs_path_traversal_blocked" time="0.415" /><testcase classname="test_api_chat_routing" name="test_chat_requires_message" time="0.334" /><testcase classname="test_api_chat_routing" name="test_chat_conversation_reuse" time="7.680"><failure message="AttributeError: 'dict' object has no attribute 'find'">client = &lt;starlette.testclient.TestClient object at 0x0000014F7A99B230&gt;
project = {'description': 'QA autogenerated project', 'id': 14, 'instruction_text': None, 'instruction_updated_at': None, ...}

    def test_chat_conversation_reuse(client, project):
        """C-Chat-04: Subsequent calls reuse conversation_id."""
&gt;       first = client.post(
            "/chat",
            json={"project_id": project["id"], "message": "first", "mode": "auto"},
        ).json()

C:\InfinityWindow_QA\qa\tests_api\test_api_chat_routing.py:31: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:546: in post
    return super().post(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:1144: in post
    return self.request(
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:445: in request
    return super().request(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\httpx\_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:348: in handle_request
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\testclient.py:345: in handle_request
    portal.call(self.app, scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\from_thread.py:326: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\Windows 11\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
C:\Users\Windows 11\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\from_thread.py:257: in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\applications.py:1139: in __call__
    await super().__call__(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\applications.py:107: in __call__
    await self.middleware_stack(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:119: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:105: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:385: in app
    raw_response = await run_endpoint_function(
C:\InfinityWindow_QA\.venv\Lib\site-packages\fastapi\routing.py:286: in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\starlette\concurrency.py:32: in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\to_thread.py:61: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\_backends\_asyncio.py:2525: in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
C:\InfinityWindow_QA\.venv\Lib\site-packages\anyio\_backends\_asyncio.py:986: in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
C:\InfinityWindow_QA\backend\app\api\main.py:3534: in chat
    clean_reply_text, file_edit_requests = _extract_ai_file_edits(raw_reply_text)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

reply_text = {'cost_estimate': 0.0, 'model': 'stub-auto', 'reply': '[stub-auto-a08d7bf1]', 'tokens_in': 736, ...}

    def _extract_ai_file_edits(reply_text: str) -&gt; tuple[str, List[Dict[str, object]]]:
        """
        Look for zero or more AI file edit request blocks in the reply text.
    
        Blocks are delimited like:
    
            &lt;&lt;AI_FILE_EDIT&gt;&gt;
            {"file_path": "backend/app/api/main.py",
             "instruction": "Describe the change to make"}
            &lt;&lt;END_AI_FILE_EDIT&gt;&gt;
    
        Returns:
            (cleaned_reply_text, list_of_edit_dicts)
        """
        edits: List[Dict[str, object]] = []
        start_tag = "&lt;&lt;AI_FILE_EDIT&gt;&gt;"
        end_tag = "&lt;&lt;END_AI_FILE_EDIT&gt;&gt;"
    
        remaining = reply_text
        while True:
&gt;           start = remaining.find(start_tag)
                    ^^^^^^^^^^^^^^
E           AttributeError: 'dict' object has no attribute 'find'

C:\InfinityWindow_QA\backend\app\api\main.py:653: AttributeError</failure></testcase><testcase classname="test_security" name="test_fs_write_traversal_blocked" time="4.322" /><testcase classname="test_search" name="test_search_docs_validation" time="4.126" /></testsuite></testsuites>